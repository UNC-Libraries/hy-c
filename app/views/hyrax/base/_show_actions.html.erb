<%# [hyc-override] Change the delete button %>
<%# [hyc-override] Show link to parent record %>
<%# [hyc-override] Hide admin only and speciality form links from non-admins %>
<% parent_solr_docs = ParentQueryService.query_parents_for_id(presenter.solr_document.id) %>

<div class="show-actions">
  <% unless parent_solr_docs.blank? %>
    <% parent_solr_docs.first(1).each do |item| %>
      <%= link_to 'Back to Parent Record', url_for_document(SolrDocument.find(item["id"])), class: 'btn btn-success', data: { turbolinks: false } %>
    <% end %>
  <% end %>
  <% if Hyrax.config.analytics? %>
    <%= link_to "Analytics", presenter.stats_path, id: 'stats', class: 'btn btn-default', data: { turbolinks: false } %>
  <% end %>
  <% if presenter.editor? %>
    <%= link_to "Edit", edit_polymorphic_path([main_app, presenter]), class: 'btn btn-default' %>
    <%# Changes start here %>
    <% if current_user.admin? %>
      <%= link_to "Delete", [main_app, presenter], class: 'btn btn-danger', data: { confirm: "Delete this #{presenter.human_readable_type}?" }, method: :delete %>
      <% if @presenter.workflow.actions.present? &&
          !@presenter.workflow.actions.select{|action| action[0] == 'withdraw'}.blank? %>
        <%= form_tag main_app.hyrax_workflow_action_path(presenter), method: :put do %>
          <%= hidden_field :workflow_action, :name, value: 'withdraw' %>
          <input class="btn btn-danger" type="submit" value="Withdraw">
        <% end %>
      <% end %>
    <% end %>
    <%# Changes end here %>
    <% if presenter.member_presenters.size > 1 %>
      <%= link_to t("hyrax.file_manager.link_text"), polymorphic_path([main_app, :file_manager, presenter]), class: 'btn btn-default' %>
    <% end %>
    <% if presenter.valid_child_concerns.length > 0 %>
      <div class="btn-group">
        <% if @presenter.workflow.present? && @presenter.workflow.is_mfa_in_review? %>
          <%= link_to "Attach Artwork", polymorphic_path([main_app, :new, :hyrax, :parent, 'artwork'], parent_id: presenter.id), class: 'btn btn-default' %>
        <% else %>
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Attach Child <span class="caret"></span>
          </button>

          <input type="checkbox"  style="display:none" name="batch_document_ids[]" id="batch_document_<%= presenter.id %>" value="<%= presenter.id %>" class="batch_document_selector" checked="checked" />
          <%= button_tag t('hyrax.dashboard.my.action.add_to_collection'),
                         class: 'btn btn-default submits-batches submits-batches-add',
                         data: { toggle: "modal", target: "#collection-list-container" } %>
            <ul class="dropdown-menu">
              <% presenter.valid_child_concerns.each do |concern| %>
                <%# [hyc-override] Hide admin only and speciality form links from non-admins %>
                <% next if (%w(General Dissertation Artwork).include? concern.model_name) && !current_user.admin?  %>

                <li>
                  <%= link_to "Attach #{concern.human_readable_type}", polymorphic_path([main_app, :new, :hyrax, :parent, concern.model_name.singular], parent_id: presenter.id) %>
                </li>
              <% end %>
            </ul>
        <% end %>
      </div>
    <% end %>

  <% end %>

  <% if presenter.show_deposit_for?(collections: @user_collections) %>
    <input type="checkbox"  style="display:none" name="batch_document_ids[]" id="batch_document_<%= presenter.id %>" value="<%= presenter.id %>" class="batch_document_selector" checked="checked" />
    <%= button_tag t('hyrax.dashboard.my.action.add_to_collection'),
                   class: 'btn btn-default submits-batches submits-batches-add',
                   data: { toggle: "modal", target: "#collection-list-container" } %>
  <% end %>

  <% if @presenter.workflow.actions.present? &&
      !@presenter.workflow.actions.select{|action| action[0] == 'request_deletion'}.blank? %>
    <button class="btn btn-danger" data-toggle="modal" data-target="#deletion-request-modal">Request Deletion</button>
  <% end %>
  <% if presenter.work_featurable? %>
    <%= link_to "Feature", hyrax.featured_work_path(presenter, format: :json),
                data: { behavior: 'feature' },
                class: presenter.display_unfeature_link? ? 'btn btn-default collapse' : 'btn btn-default' %>

    <%= link_to "Unfeature", hyrax.featured_work_path(presenter, format: :json),
                data: { behavior: 'unfeature' },
                class: presenter.display_feature_link? ? 'btn btn-default collapse' : 'btn btn-default' %>
  <% end %>
</div>

<!-- COinS hook for Zotero -->
<span class="Z3988" title="<%= export_as_openurl_ctx_kev(presenter) %>"></span>
<!-- Render Modals -->
<%= render 'hyrax/dashboard/collections/form_for_select_collection', user_collections: @user_collections %>